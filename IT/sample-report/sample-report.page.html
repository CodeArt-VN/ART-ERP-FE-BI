<ion-header>
	<app-list-toolbar [pageConfig]="pageConfig" [selectedItems]="selectedItems" [query]="query" (add)="add()" (refresh)="refresh()" (export)="export()" (import)="import($event)" (help)="help()" (unselect)="unselect()" (archiveItems)="archiveItems()" (deleteItems)="deleteItems()" (changeBranch)="changeBranch($event)"></app-list-toolbar>
</ion-header>

<ion-content appScrollbarTheme class="scrollx">
	<ion-refresher [disabled]="!pageConfig.refresher" [disabled]="!pageConfig.refresher" slot="fixed" (ionRefresh)="refresh($event)">
		<ion-refresher-content></ion-refresher-content>
	</ion-refresher>
	<ion-fab *ngIf="pageConfig.isShowFeature" class="feature" vertical="top" horizontal="end" slot="fixed">
		<div class="ion-padding">

		</div>
	</ion-fab>

	<div class="ion-padding">
		<app-page-title [icon]="pageConfig.pageIcon" [title]="pageConfig.pageTitle" [remark]="pageConfig.pageRemark">
			<div rightContent class="mini-chart" [ngClass]="{'box-shadow': showFullChart}">
				<div class="mini-chart-control">
					<ion-button fill="clear" size="small" (click)="toggleMiniChart()">
						<ion-icon slot="icon-only" name="resize"></ion-icon>
					</ion-button>
				</div>

				<div class="statistic-row">
					<div class="card-multirow" [ngClass]="{selected: viewDimension == 'Count'}" (click)="buildDataset('Count')">
						<div class="card-header">Count</div>
						<div class="card-value">{{1595 | number: '1.0-0' }}</div>
						<ion-text color="success" class="card-compare-percent">
							24%
							<ion-icon name="caret-up"></ion-icon>
						</ion-text>
						<div class="card-chart-preview">

						</div>
					</div>
					<div class="card-multirow " [ngClass]="{selected: viewDimension == 'Total'}" (click)="buildDataset('Total')">
						<div class="card-header">Total</div>
						<div class="card-value">152055</div>
						<ion-text color="warning" class="card-compare-percent">
							0%
							<ion-icon name="caret-up"></ion-icon>
						</ion-text>
						<div class="card-chart-preview">

						</div>
					</div>
					<div class="card-multirow" [ngClass]="{selected: viewDimension == 'Discount'}" (click)="buildDataset('Discount')">
						<div class="card-header">Discount</div>
						<div class="card-value">152055</div>
						<ion-text color="danger" class="card-compare-percent">
							24%
							<ion-icon name="caret-down"></ion-icon>
						</ion-text>
						<div class="card-chart-preview">

						</div>
					</div>
				</div>

				<div style="height: 100%; width: 100%;" class="box" id="{{elId}}"></div>
			</div>

		</app-page-title>

		<section class="table responsive box-shadow">
			<header class="bold">
				<div class="col-checkbox cell"></div>
				<div class="col-id cell" (click)="sortToggle('Id')">
					{{'Id' | translate}}
					<ion-icon class="min-btn" *ngIf="sort.Id" [name]="sort.Id == 'Id'?'arrow-down': 'arrow-up'"></ion-icon>
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="query.Id" name="search" color="primary"></ion-icon>
				</div>
				<div class="col-name cell" (click)="sortToggle('Title')">
					{{'Title' | translate}}
					<small class="taxid">{{'erp.app.pages.accountant.ar-invoice.taxid' | translate}}</small>
					<ion-icon class="min-btn" *ngIf="sort.Title" [name]="sort.Title == 'Title'?'arrow-down': 'arrow-up'"></ion-icon>
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="query.Title" name="search" color="primary"></ion-icon>
				</div>

				<div class="col-number cell" [ngClass]="{selected: viewDimension == 'Count'}" (click)="sortToggle('Count')">
					{{'Count' | translate}}
					<ion-icon class="min-btn" *ngIf="sort.Count" [name]="sort.Count == 'Count'?'arrow-down': 'arrow-up'"></ion-icon>
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="query.Count" name="search" color="primary"></ion-icon>
				</div>

				<div class="col-money cell" [ngClass]="{selected: viewDimension == 'Total'}" (click)="sortToggle('Total')">
					{{'Total' | translate}}
					<ion-icon class="min-btn" *ngIf="sort.Total" [name]="sort.Total == 'Total'?'arrow-down': 'arrow-up'"></ion-icon>
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="query.Total" name="search" color="primary"></ion-icon>
				</div>

				<div class="col-money cell" [ngClass]="{selected: viewDimension == 'Discount'}" (click)="sortToggle('Discount')">
					{{'Discount' | translate}}
					<ion-icon class="min-btn" *ngIf="sort.Discount" [name]="sort.Discount == 'Discount'?'arrow-down': 'arrow-up'"></ion-icon>
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="query.Discount" name="search" color="primary"></ion-icon>
				</div>
				<div class="col-remark cell"></div>

				
			</header>
			<div class="table-body">
				<app-page-message [itemsLength]="items.length" [showSpinner]="pageConfig.showSpinner"></app-page-message>
				<ion-virtual-scroll [items]="items" approxItemHeight="27px" *ngIf="items.length && pageConfig.showSpinner==false">
					<ng-container *virtualItem="let i; let itemBounds = bounds; let j = index;">
						<div class="row" [ngClass]="{odd: j % 2 != 0}" [ngClass]="{selected: i.checked}">
							<div class="col-checkbox cell">
								<input (click)="changeSelection(i, $event)" class="c-checkbox" [(ngModel)]="i.checked" type="checkbox">
							</div>
							<div (click)="nav('sale-order/'+i.Id,'forward')" class="col-id cell">
								<a [routerLink]="['sale-order/'+i.Id]">{{i.Id}}</a>
							</div>

							<div class="col-name cell">
								{{i.Title}}
							</div>
							
							<div class="col-number cell" [ngClass]="{selected: viewDimension == 'Count'}"><span>{{i.Count | number: '1.0-0'}}</span></div>
							<div class="col-money cell" [ngClass]="{selected: viewDimension == 'Total'}"><span>{{i.Total | number: '1.0-0'}}</span></div>
							<div class="col-money cell" [ngClass]="{selected: viewDimension == 'Discount'}"><span>{{i.Discount | number: '1.0-0'}}</span></div>
							
							<div class="col-remark cell"></div>
						</div>
					</ng-container>
				</ion-virtual-scroll>
			</div>
			
		</section>
	</div>

	<ion-infinite-scroll color="primary" threshold="20%" (ionInfinite)="loadData($event)" [disabled]="!pageConfig.infiniteScroll || pageConfig.isEndOfData">
		<ion-infinite-scroll-content loadingSpinner="dots"></ion-infinite-scroll-content>
	</ion-infinite-scroll>
</ion-content>
